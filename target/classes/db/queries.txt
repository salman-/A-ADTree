
--insert into threatAgent (means,motivation,capabilities,opportunities) values( 'computer','ideology','expert','infinite' )
--select * from threatAgent where id=1
--delete from threatAgent where id=1
--update threatAgent set means='means',motivation='Motivation',capabilities='Step stone privilage', opportunities='Zero' where id=2
--delete from threatAgent


--insert into countermeasure (name, description, probability,cost)values('Encryption', 'description' ,0.5  ,1000 )
--update countermeasure  set  name='Name', description='Description', probability=0.66,cost=2000 where id=1
--delete from countermeasure  where id=1
--delete from countermeasure
--select * from countermeasure  where  id=2

--insert into attack ( name,description, probability, asset_id,threatAgent_id,vulnerability_id, countermeasure_id )    values ('DDOS','bla',    0.3,      3,    3, 16,  2  )
--update attack set name='Name', description='Description', probability=0.4,asset_id=3,threatAgent_id=3, vulnerability_id= 16, countermeasure_id=2    


CREATE TABLE "attack" (
      "id" INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL ,
      "name" VARCHAR , 
      "description" TEXT check(typeof("description") = 'text') , 
      "probability" DOUBLE ,
      "date" VARCHAR ,
	"costOfDamage" VARCHAR ,
	"costOfAttack"VARCHAR ,
      "asset_id" INTEGER , 
      "threatAgent_id" INTEGER  ,
      "vulnerability_id"  INTEGER  ,
      "countermeasure_id" INTEGER  ,
      "impact_id" INTEGER  ,

      FOREIGN KEY ( "asset_id") REFERENCES  asset(id)   ,
      FOREIGN KEY ( "impact_id") REFERENCES  impact(id)   ,
      FOREIGN KEY ( "threatAgent_id") REFERENCES  threatAgent(id) ,
      FOREIGN KEY ( "vulnerability_id") REFERENCES  vulnerability(id),
      FOREIGN KEY ( "countermeasure_id") REFERENCES  countermeasure(id))



CREATE  TABLE "main"."impact" ("id" INTEGER, "name" VARCHAR PRIMARY KEY  NOT NULL  UNIQUE , "description" VARCHAR, "level" INTEGER,"type" VARCHAR)



CREATE  TABLE "main"."impact" ("id" INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL , "name" VARCHAR NOT NULL , "description" VARCHAR, "level" VARCHAR, "type" VARCHAR)


SELECT  attack.id,attack.name as Attack,attack.description,costOfAttack,costOfDamage,
              asset.name as Asset,impact.name as Impact,attack.probability,vulnerability .name as vulnerability 
FROM    attack    inner join  asset on attack.asset_id=asset.id
                              inner join  impact on attack.impact_id=impact.id
                              inner join  vulnerability on attack.vulnerability_id=vulnerability.id






